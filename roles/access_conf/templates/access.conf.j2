{{ ansible_managed | comment }}
# Generated by Ansible role {{ ansible_role_name }}

{% if access_conf_allow_root %}
# Default rule: Allow root access from anywhere
+:root:ALL
{% endif %}

{% if access_conf_entries_common | length > 0 %}
# Common rules
{% for item in access_conf_entries_common %}
{{ item['permissions'] | default('+') }}:{{ item['name'] }}:{{ ' '.join(item['origins']) }}
{% endfor %}
{% endif %}

{% if access_conf_entries_extra | length > 0 %}
# Host-specific rules
{% for item in access_conf_entries_extra %}
{{ item['permissions'] | default('+') }}:{{ item['name'] }}:{{ ' '.join(item['origins']) }}
{% endfor %}
{% endif %}

{% if access_conf_default_deny %}
# Default rule: Deny all other access
-:ALL:ALL
{% endif %}
