{{ ansible_managed | comment }}
# Generated by Ansible role {{ ansible_role_name }}

{% if access_conf_allow_root %}
# Default rule: Allow root access from anywhere
+:root:ALL
{% endif %}

{% if access_conf_common_entries | length > 0 %}
# Common rules
{% for entry in access_conf_common_entries %}
{{ entry.permissions | default('+') }}:{{ entry.name }}:{{ ' '.join(entry.origins) }}
{% endfor %}
{% endif %}

{% if access_conf_extra_entries | length > 0 %}
# Host-specific rules
{% for entry in access_conf_extra_entries %}
{{ entry.permissions | default('+') }}:{{ entry.name }}:{{ ' '.join(entry.origins) }}
{% endfor %}
{% endif %}

{% if access_conf_default_deny %}
# Default rule: Deny all other access
-:ALL:ALL
{% endif %}
